                      Client send                     │                      Server sends
                                                      │
          +----+----------+----------+                │        +----+--------+
          |VER | NMETHODS | METHODS  |                │        |VER | METHOD |
          +----+----------+----------+ ───────────────┼──────► +----+--------+
          | 1  |    1     | 1 to 255 |                │        | 1  |   1    |
          +----+----------+----------+                │        +----│--------+
                                                      │             │
                                                      │             │
                          ┌───────────────────────────┼─────────────┘
                          ▼                           │
+----+-----+-------+------+----------+----------+     │
|VER | CMD |  RSV  | ATYP | DST.ADDR | DST.PORT |     │
+----+-----+-------+------+----------+----------+     │
| 1  |  1  | X'00' |  1   | Variable |    2     |     │
+----+-----+-------+------│----------+----------+     │
                          │                           │
                          │                           │
                          └───────────────────────────┼──────────────────────────┐
                                                      │                          │
                                                      │                          │
                                                      │       +----+-----+-------▼------+----------+----------+
                                                      │       |VER | REP |  RSV  | ATYP | BND.ADDR | BND.PORT |
                                                      │       +----+-----+-------+------+----------+----------+
                                                      │       | 1  |  1  | X'00' |  1   | Variable |    2     |
                                                      │       +----+-----+-------│------+----------+----------+
               ┌────────────────┐                     │                          │
               │ Starts sending │◄────────────────────┼──────────────────────────┘
               │ data to server │                     │
               │ via socks5     │                     │
               │ proxy          │                     │
               └────────────────┘                     │